# Okay lets see what we have by doing a ls -la

level10@SnowCrash:~$ ls -la
total 28
dr-xr-x---+ 1 level10 level10   140 Mar  6  2016 .
d--x--x--x  1 root    users     340 Aug 30  2015 ..
-r-x------  1 level10 level10   220 Apr  3  2012 .bash_logout
-r-x------  1 level10 level10  3518 Aug 30  2015 .bashrc
-r-x------  1 level10 level10   675 Apr  3  2012 .profile
-rwsr-sr-x+ 1 flag10  level10 10817 Mar  5  2016 level10
-rw-------  1 flag10  flag10     26 Mar  5  2016 token

# Lets see what happens when running the file

level10@SnowCrash:~$ ./level10
./level10 file host
	sends file to host if you have access to it

# Lets see whats happens when giving it token

level10@SnowCrash:~$ ./level10 token
./level10 file host
	sends file to host if you have access to it

# Lets see what in token

level10@SnowCrash:~$ cat token
cat: token: Permission denied

# We see there is unprintable characters so lets see what it is with using vim
level09@SnowCrash:~$ vim token
f4kmm6p|=~B^?p~Bn~C~BDB~CDu{^?~L~I

# Lets see what we get with giving level09 our own argument and see the out put
level09@SnowCrash:~$ ./level09 Gabe
Gbdh
level09@SnowCrash:~$ ./level09 test
tfuw
level09@SnowCrash:~$ ./level09 abcd
aceg
level09@SnowCrash:~$ ./level09 aaaa
abcd
level09@SnowCrash:~$ ./level09 1234
1357
level09@SnowCrash:~$ ./level09 1111
1234

# Bingo! now we see a pattern emerged and we can see that the program is incrementing the ascii value of the inputs by the coloumb number it is in
							   0123		it increases by 1 as the coloumb number of the character
level09@SnowCrash:~$ ./level09 aaaa
abcd
#		Thus it will increase that current character in the coloumb by the coloumb number, starting from 0 

# So all we need to do is make a script that will reverse this on the token file, making a tmp of that token file with the reversed effect

level09@SnowCrash:~$ vim /tmp/reverse.py

import sys

for i, val in enumerate(sys.argv[1]):
     sys.stdout.write(chr(ord(val)-i))
     sys.stdout.flush()
print

# Now we will run this script on the token file and cat it
level09@SnowCrash:~$ python /tmp/reverse.py `cat token`
f3iji1ju5yuevaus41q1afiuq

# Remember to su the flag as this only gave us the Password for the flag.

level09@SnowCrash:~$ su flag09
Password:
Don't forget to launch getflag !
flag09@SnowCrash:~$ getflag
Check flag.Here is your token : s5cAJpM8ev6XHw998pRWG728z
